{"version":3,"sources":["../../../client/app/events/events.controller.js"],"names":[],"mappings":"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","file":"events.controller.js","sourcesContent":["'use strict';\r\n\r\nangular.module('eventsMongoApp')\r\n  .controller('EventsCtrl', function($scope,$timeout, socket, CalendarEvent, Auth) {\r\n    var newEventDefaults = {\r\n      title: \"Untitled Event\",\r\n      description: \"\",\r\n      className: \"\",\r\n      icon: \"\",\r\n      allDay: false,\r\n      User: {}\r\n    };    \r\n    $scope.userInfo = {}\r\n    $scope.newEvent = {};\r\n    $scope.getCurrentUser = Auth.getCurrentUser;\r\n    \r\n    $scope.getCurrentUser(function(user) {\r\n      $scope.currentUser = user;\r\n      $scope.userInfo.user = $scope.currentUser.name;\r\n      $scope.userInfo.createdDate = new Date();\r\n      newEventDefaults.creator = $scope.currentUser._id;\r\n    });\r\n\r\n    CalendarEvent.query().$promise.then(response => {\r\n      $scope.events = response\r\n      socket.syncUpdates('events', $scope.events);\r\n    });\r\n\r\n    $('.new-event-collapse').sideNav({\r\n      menuWidth: 450,\r\n      edge: 'right'\r\n    });\r\n\r\n    $('.new-event-close-collapse').click(function() {\r\n      $timeout(function() {\r\n        $scope.newEvent = {};\r\n        $('.new-event-collapse').sideNav('hide');\r\n      }, 0, false);\r\n    });\r\n    \r\n    $scope.openForm=function(){\r\n      console.log('asdfasdf');\r\n      $timeout(function() {\r\n        $scope.newEvent = {};\r\n        $('.new-event-collapse').sideNav('show');\r\n      }, 0, true);\r\n    }\r\n\r\n    var eve = $(\"#new-event-out\").height();\r\n    $('.events-side-navigation').height(eve).perfectScrollbar({\r\n      suppressScrollX: true\r\n    });\r\n\r\n    $scope.newEvent.edate = moment().format('MMM, D dddd');\r\n    $scope.newEvent.today = new Date();\r\n    $scope.$watch('newEvent.edate', function handleDateChange(newValue, oldValue) {\r\n      if (!newValue)\r\n        $scope.newEvent.edate = moment().format('MMM, D dddd');\r\n    });\r\n    $scope.isEdit=false;\r\n    $scope.editEvent = function(item) {\r\n      $timeout(function() {\r\n        $scope.isEdit=true;\r\n        $scope.newEvent = angular.copy(item);\r\n        $scope.newEvent.starttime = moment.utc(item.start).format(\"hh:mmA\");\r\n        $scope.newEvent.endtime = moment.utc(item.end).format(\"hh:mmA\");\r\n        $('.new-event-collapse').sideNav('show');\r\n      }, 1, true);\r\n    }\r\n    \r\n    $scope.saveEvent = function() {\r\n\r\n      if ($scope.newEvent && !$scope.newEvent.edate)\r\n      {\r\n        $scope.newEvent.edate = moment().format();\r\n      }  \r\n      if ($scope.newEvent && !$scope.newEvent.starttime)\r\n      {\r\n        $scope.newEvent.starttime = moment().format(\"HH:mm\");\r\n      }  \r\n      if ($scope.newEvent && !$scope.newEvent.endtime)\r\n      {\r\n        $scope.newEvent.endtime = moment().add(1, 'hour').format(\"HH:mm\");\r\n      }  \r\n      \r\n      var currentDate = moment($scope.newEvent.edate.toString(), \"MMM, D dddd\").format(\"YYYY-MM-DD\");\r\n      var startTime = moment($scope.newEvent.starttime.toString(), \"h:mm a\").format(\"HH:mm\");\r\n      var endTime = moment($scope.newEvent.endtime.toString(), \"h:mm a\").format(\"HH:mm\");\r\n\r\n      $scope.newEvent.start = moment(currentDate.toString() + ' ' + startTime.toString() + ' +0000', \"YYYY-MM-DD HH:mm Z\")\r\n      $scope.newEvent.end = moment(currentDate.toString() + ' ' + endTime.toString() + ' +0000', \"YYYY-MM-DD HH:mm Z\")\r\n      var newEvent = angular.extend(newEventDefaults, $scope.newEvent);\r\n\r\n      // Save-Update Events\r\n      \r\n      if (newEvent._id) {\r\n\r\n      CalendarEvent.update({\r\n        id: newEvent._id\r\n      }, newEvent).$promise.then(function() {\r\n        Materialize.toast('Event updated.', 2000, '', function() { });\r\n      }, function(error) { // error handler\r\n        if (error.data.errors) {\r\n          var err = error.data.errors;\r\n          console.log(err[Object.keys(err)].message, err[Object.keys(err)].name);\r\n        } else {\r\n          var msg = error.data.message;\r\n          console.log(msg);\r\n        }\r\n      });\r\n    }\r\n    else {\r\n      CalendarEvent.save(newEvent).$promise.then(function() {\r\n        Materialize.toast('Event added.', 2000, '', function() { });\r\n\t\t\t\t\t}, function(error) { // error handler\r\n\t\t\t\t\t\tif (error.data.errors) {\r\n\t\t\t\t\t\t\tvar err = error.data.errors;\r\n\t\t\t\t\t\t\tconsole.log(err[Object.keys(err)].message, err[Object.keys(err)].name);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar msg = error.data.message;\r\n\t\t\t\t\t\t\tconsole.log(msg);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n    }\r\n    \r\n    $timeout(function() {\r\n      $scope.newEvent = {};\r\n      newEvent={};\r\n      $('.new-event-collapse').sideNav('hide');\r\n    });\r\n      // END\r\n    }\r\n\r\n    $scope.$on('$destroy', function() {\r\n      socket.unsyncUpdates(\"events\");\r\n    });\r\n\r\n    \r\n  }).filter('UTCToNow', function() {\r\n    return function(input, format) {\r\n      return moment.utc(input).format('dddd, MMMM Do YYYY, h:mmA');\r\n    }\r\n  });\r\n  \r\n"]}